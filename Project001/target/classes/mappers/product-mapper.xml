<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="edu.spring.p01.ProductMapper">
	<!-- DAOImple의 순서와 메소드 이름이 비슷하게 생성 꼭 인지 -->
	
	<!-- 상품 등록 -->
	<insert id="insert">
		insert into ${pro01_product} (${productName}, ${productCategory}, ${productPrice}, ${productAmount}, ${productIntro})
			values (#{productName}, #{productCategory}, #{productPrice}, #{productAmount}, #{productIntro})
	</insert>
	
	<!-- 상품 전체 읽기 -->
	<select id="read_all">
		select * from ${pro01_product}
		order by ${productNo} desc
	</select>
	
	<!-- 상품 상세 -->
	<select id="select_by_productNo" resultType="ProductVO">
		select * from ${pro01_product} where ${productNo} = #{productNo}
	</select>
	
	<!-- 상품 정보 수정 -->
	<update id="update">
		update ${pro01_product}
		set ${productName} = #{productName},
			${productCategory} = #{productCategory},
			${productPrice} = #{productPrice},
			${productAmount} = #{productAmount},
			${productIntro} = #{productIntro}
		where ${productNo} = #{productNo}
	</update>
	
	<!-- 상품 정보 삭제 -->
	<delete id="delete">
		delete from ${pro01_product}
		where ${productNo} = #{productNo}
	</delete>
	
	<!-- 상품 총 개수 -->
	<select id="product_total_count" resultType="Integer">
	<![CDATA[
	     select count(*) from ${pro01_product}
    ]]>
	     <if test="keyword != null">
	     	 where product_name like '%' || #{keyword} || '%'
     	</if>
	</select>
	
	<!-- 상품 전체 불러오기 -->
	<select id="product_select_all" resultType="productVO">  
	<![CDATA[
          select * from (
            select /*+INDEX_DESC(pro01_product PROJECT01_PRODUCET_PK) */ 
                  rownum as rn, product_no, product_name, product_category, product_price, product_amount, product_intro, product_reg_date
            from pro01_product 
            where
             
    ]]>         
            <if test="keyword != null">
                product_name like '%'|| #{keyword} || '%' and
            </if>
            
    <![CDATA[        
             rownum <= #{page} * #{numsPerPage}
            )
        where rn > (#{page} - 1) * #{numsPerPage}
      ]]>
    </select>
    
    <!-- 상품명 선택 -->
    <select id="select_by_pName" resultType="ProductVO">
    	select * from ${pro01_product}
    	where ${productName} like #{productName}
    </select>
    
    <!-- 상품 키워드로 검색 -->
    <select id="select_by_title_content" resultType="ProductVO">
    	select * from ${pro01_product}
    	where ${productName} like #{keyword} or
    		  ${category} like #{keyword}
    		  order by #{productNo} desc
    </select>
   
   
</mapper>










